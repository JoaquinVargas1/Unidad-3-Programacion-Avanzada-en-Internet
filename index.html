<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
</head>
<body>
    <div id="main">
        <h1>Login</h1>
        <form @submit.prevent="iniciarSesion">

            <fieldset v-if="!sesionIniciada">

                <label> Usuario: </label>
                <input type="text" v-model="usuario" />

            </fieldset>

            <fieldset v-if="!sesionIniciada">

                <label> Contraseña: </label>
                <input type="password" v-model="contrasena" />

            </fieldset>

            <br>

            <button v-if="!sesionIniciada" type="submit">Iniciar Sesión</button>

            <h1 v-if="sesionIniciada">¡Bienvenido, {{ usuario }}!</h1>

        </form>

    </div>

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <script>
        const { createApp, ref } = Vue;

        createApp({

            data() {
                return {
                    usuario: '',
                    contraseña: '',
                    sesionIniciada: false, 
                    mensajeError: ''
                };
            },

            methods: {

                iniciarSesion() {
                    fetch('usuarios.json')
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Error al cargar el archivo JSON');
                            }
                            return response.json();
                        })

                        .then(data => {
                            const usuarioValido = data.find(u => 
                                u.email === this.usuario && u.password === this.contraseña
                            );
                            if (usuarioValido) {

                                this.sesionIniciada = true;
                            } else {
                                alert('Usuario o contraseña incorrectos');
                            }
                        })

                        .catch(err => {

                            alert('Error al cargar usuarios: ' + err.message);

                        });
                }
            }
        }).mount('#main');
        
    </script>
</body>
</html>
